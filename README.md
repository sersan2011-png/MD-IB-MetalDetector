MetalDetector_IB/
‚îú‚îÄ‚îÄ Core/
‚îÇ   ‚îú‚îÄ‚îÄ Src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.c
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ili9341.c
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fonts.c
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ eeprom_24c08.c
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ adc_tpc5160.c
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ menu.c
‚îÇ   ‚îú‚îÄ‚îÄ Inc/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ili9341.h
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fonts.h
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ eeprom_24c08.h
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ Drivers/
‚îî‚îÄ‚îÄ STM32F411CEUx_FLASH.ld
‚úÖ ILI9341 + —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫

‚úÖ TPC5160 (–ê–¶–ü)

‚úÖ 24C08 EEPROM (–ø—Ä–æ—Ñ–∏–ª–∏)

‚úÖ KY0803L + PT23119 (–∑–≤—É–∫)

‚úÖ 5 –∫–Ω–æ–ø–æ–∫ (–º–µ–Ω—é)

‚úÖ VDI, —Å–∏–≥–Ω–æ–≥—Ä–∞—Ñ, –≥–æ–¥–æ–≥—Ä–∞—Ñ

‚úÖ –ê–≤—Ç–æ–±–∞–ª–∞–Ω—Å, –∞–≤—Ç–æ–ø–æ–∏—Å–∫ —á–∞—Å—Ç–æ—Ç—ã

‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –±–∞—Ç–∞—Ä–µ–∏

‚úÖ –ú–µ–Ω—é –Ω–∞ —Ä—É—Å—Å–∫–æ–º


–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Å–±–æ—Ä–∫–µ –∂–µ–ª–µ–∑–∞
–ü–ª–∞—Ç–∞ —Ä–∞—Å–ø–∞–π–∫–∏ (–º–∏–Ω–∏-–≤–µ—Ä—Å–∏—è)
STM32	–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫
PA4	TPC5160 ‚Äî /CS
PA5	TPC5160 ‚Äî SCLK
PA6	TPC5160 ‚Äî DOUT
PA7	TPC5160 ‚Äî DIN (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
PB12	ILI9341 ‚Äî /CS
PB13	ILI9341 ‚Äî SCK
PB15	ILI9341 ‚Äî MOSI
PB1	ILI9341 ‚Äî DC
PB0	ILI9341 ‚Äî RST
PB8, PB9	24C08, PT23119 ‚Äî SCL, SDA
PA8	KY0803L ‚Äî FM_IN
PA0	–î–µ–ª–∏—Ç–µ–ª—å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –±–∞—Ç–∞—Ä–µ–∏ (10–∫ + 2–∫)


–®—Ä–∏—Ñ—Ç—ã —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π
–°–æ–∑–¥–∞–π—Ç–µ fonts.h –∏ fonts.c —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã.

fonts.h
c
typedef struct {
    const uint8_t width;
    uint8_t height;
    const uint16_t *data;
} FontDef;

extern FontDef Font_11x18;
extern FontDef Font_16x26;

void LCD_DrawChar(uint16_t x, uint16_t y, char c, FontDef* font, uint16_t color, uint16_t bg);
üîΩ –°–∫–∞—á–∞–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ —à—Ä–∏—Ñ—Ç—ã —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π –ø–æ —Å—Å—ã–ª–∫–µ:
 ‚Äî —Ç–∞–º –µ—Å—Ç—å fonts.c —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π UTF-8 –∏ –∫–∏—Ä–∏–ª–ª–∏—Ü—ã.

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ FontConverter (–æ—Ç mikroElektronika) –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–≤–æ–∏—Ö —à—Ä–∏—Ñ—Ç–æ–≤ —Å —Å–∏–º–≤–æ–ª–∞–º–∏ –ê-–Ø, –∞-—è.


1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤ STM32CubeIDE
–®–∞–≥ 1: –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
–û—Ç–∫—Ä–æ–π—Ç–µ STM32CubeIDE.

File ‚Üí New ‚Üí STM32 Project.

–í—ã–±–µ—Ä–∏—Ç–µ:

STM32F411CEUx (64-pin, 512‚ÄØ–ö–ë Flash, 128‚ÄØ–ö–ë RAM)

–ù–∞–∑–æ–≤–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä: MetalDetector_IB

–ù–∞–∂–º–∏—Ç–µ Finish

–®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (RCC, Clock)
RCC ‚Üí High Speed Clock (HSE): Crystal/Ceramic Resonator

Clock Configuration:

HCLK = 100‚ÄØ–ú–ì—Ü (–º–∞–∫—Å–∏–º—É–º –¥–ª—è F411)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PLL: HSE √ó 25 ‚Üí PLL √ó 4 ‚Üí 100‚ÄØ–ú–ì—Ü

–®–∞–≥ 3: –í–∫–ª—é—á–∏—Ç–µ –ø–µ—Ä–∏—Ñ–µ—Ä–∏—é
–ü–µ—Ä–∏—Ñ–µ—Ä–∏—è	–ù–∞—Å—Ç—Ä–æ–π–∫–∞
SPI1	–î–ª—è TPC5160: Full-Duplex Master, NSS = Hardware (PA4), Baud = fPCLK/64 (‚âà1.5‚ÄØ–ú–ì—Ü)
SPI2	–î–ª—è ILI9341: Full-Duplex Master, NSS = Software (PB12), Baud = fPCLK/16
I2C1	–î–ª—è 24C08 –∏ PT23119: I2C, 100‚ÄØ–∫–ì—Ü
ADC1	–î–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –±–∞—Ç–∞—Ä–µ–∏: Channel 0 (PA0), 12‚ÄØ–±–∏—Ç
TIM1	–î–ª—è PWM –∑–≤—É–∫–∞ (KY0803L): CH1 (PA8), PWM Generation CH1
GPIO	–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –∫–∞–∫ –≤—Ö–æ–¥—ã —Å –ø–æ–¥—Ç—è–∂–∫–æ–π –≤–≤–µ—Ä—Ö
